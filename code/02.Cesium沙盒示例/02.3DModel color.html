<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="../../public/Cesium/Cesium.js"></script>
    <link rel="stylesheet" href="../../public/Cesium/Widgets/widgets.css">
    <title>3DModel color</title>
</head>
<style>

</style>

<body>
    <div id="cesiumContainer" class="fullSize"></div>
</body>
<script type="module">
    //Cesium初始化
    Cesium.Ion.defaultAccessToken =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIzZjY5M2UwNi1kODhmLTQzZTItYjc4Ni0yMzlmNTBlYmIxYjgiLCJpZCI6MTU3NTE3LCJpYXQiOjE2OTQ1MDMyOTl9.PSElCoyLF_ecNszBWrrOmB9JH7yPxrSLo-Tx4DIm1LU";
    var viewer = new Cesium.Viewer("cesiumContainer", {
        infoBox: false,
        selectionIndicator: false,
        shadows: true,
        shouldAnimate: true
    });

    let entity;

    //获取颜色之间的混合模式
    function getColorBlendMode(colorBlendMode) {
        return Cesium.ColorBlendMode[colorBlendMode.toUpperCase()]
    }

    //获取加了透明度的颜色
    function getColor(colorName, alpha) {
        const color = Cesium.Color[colorName.toUpperCase()];
        return Cesium.Color.fromAlpha(color, parseFloat(alpha))
    }

    //The viewModel tracks the state of our mini application
    const viewModel = {
        color: 'Red',
        colors: ["White", 'Red', "Green", "Blue", "Yellow", "Gray"],
        alpha: 1.0,
        colorBlendMode: 'Highlight',
        colorBlendModes: ["Highlight", "Replace", "Mix"],
        colorBlendAmount: 0.5,
        colorBlendAmountEnabled: false,
        silhouetteColor: "Green",
        silhouetteColors: ["Red", "Green", "Blue", "Yellow", "Gray"],
        silhouetteAlpha: 1.0,
        silhouetteSize: 2.0
    }

    function createModel(url, height) {
        viewer.entities.removeAll();

        const position = Cesium.Cartesian3.fromDegrees(
            -123.0744619,
            44.0503706,
            height
        )

        const heading = Cesium.Math.toRadians(135);
        const pitch = 0;
        const roll = 0;
        const hpr = new Cesium.HeadingPitchRoll(heading, pitch, roll);
        const orientation = Cesium.Transforms.headingPitchRollQuaternion(
            position,
            hpr
        );

        entity = viewer.entities.add({
            name: url,
            position: position,
            orientation: orientation,
            model: {
                uri: url,
                minimumPixelSize: 128,
                maximumScale: 20000,
                color: getColor(viewModel.color, viewModel.alpha),
                colorBlendMode: getColorBlendMode(viewModel.colorBlendMode),
                colorBlendAmount: parseFloat(viewModel.colorBlendAmount),
                silhouetteColor: getColor(
                    viewModel.silhouetteColor,
                    viewModel.silhouetteAlpha
                ),
                silhouetteSize: parseFloat(viewModel.silhouetteSize)
            }
        })
        viewer.trackedEntity = entity
    }
    let url = '../../assest/CesiumAir/Cesium_Air.glb'
    createModel(url, 50000)

</script>

</html>